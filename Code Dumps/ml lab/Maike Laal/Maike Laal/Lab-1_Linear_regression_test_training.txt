Lab-1

Lab Problem 1.  (Part A) Write a Python Program for Linear Regression (Least Squares) using the Train and Test data attached.
Please compute (i) MSE train error and (ii) MSE test error. Plot the Linear Regression (Least Squares line) on (iii) the training data and (iv) the test data. 
(Part B) Finally, perform (Stochastic) Gradient Descent and plot the transition of the parameters: coef_ (coefficient) and intercept_(intercept) across the iteration numbers and for multiple batch sizes like, 20, 40, 60, 80, 100.

import pandas as pd
import numpy as np
import matplotlib.pyplot as plt
from sklearn.linear_model import LinearRegression, SGDRegressor
from sklearn.metrics import mean_squared_error as MSE
from sklearn.model_selection import train_test_split


dtrain = pd.read_csv('train_data (1).csv')
dtest = pd.read_csv('test_data (1).csv')
X_train = dtrain[['x']]
Y_train = dtrain['y']
X_test = dtest[['x']]
Y_test = dtest['y']
plt.scatter(dtrain['x'] , dtrain['y'])
plt.title("X vs Y")
plt.ylabel("Y")
plt.xlabel('X')
plt.show()



model = LinearRegression()
model.fit(X_train , Y_train)
model.score(X_test , Y_test)
Y_train_pred = model.predict(X_train)
Y_test_pred = model.predict(X_test)
mse_train = MSE(Y_train , Y_train_pred)
mse_test = MSE(Y_test , Y_test_pred)
print("Coefficient:", model.coef_)
print("Intercept:", model.intercept_)
print("MSE Train:", mse_train)
print('MSE Test:', mse_test)



plt.subplot(1,2,1)
plt.scatter(X_train , Y_train , color = 'blue' , label = "Training Data")
plt.plot(X_train , Y_train_pred , color = 'red' , linewidth = 2 , label = "Regression Line")
plt.xlabel("x")
plt.ylabel("y")
plt.title("Linear Regression on Training Data")
plt.legend()
plt.subplot(1,2,2)
plt.scatter(X_test , Y_test , color = 'blue' , label = "Test Data")
plt.plot(X_test , Y_test_pred , color = 'red' , linewidth = 2 , label = "Regression Line")
plt.xlabel("x")
plt.ylabel("y")
plt.title("Linear Regression on Test Data")
plt.legend()
plt.show()





X = X_train.values      # converts DataFrame â†’ numpy array
Y = Y_train.values.ravel()
batch_sizes = [20 , 40 , 60 , 80 , 100]
coef = []
intercept = []
coef_history = {}
intercept_history = {}


for b in batch_sizes:
  sgd = SGDRegressor(max_iter=1 , tol=None , learning_rate="constant" , eta0=0.01, random_state=42)

  for epoch in range(50):
    idx = np.random.permutation(len(X))
    X_shuffled = X[idx]
    Y_shuffled = Y[idx]

    for i in range(0 , len(X) ,b):
      X_batch = X_shuffled[i:i+b]
      Y_batch = Y_shuffled[i:i+b]
      sgd.partial_fit(X_batch , Y_batch.ravel())

  coef.append(sgd.coef_[0])
  intercept.append(sgd.intercept_[0])

  print(f"Batch Size: {b}  |  Coef: {sgd.coef_[0]:.4f}  |  Intercept: {sgd.intercept_[0]:.4f}")






plt.figure(figsize=(10,6))
plt.subplot(1,2,1)
plt.plot(batch_sizes , coef , 'o-b', color = 'blue')
plt.title("Coefficient vs Batch Size")
plt.xlabel("Batch Size")
plt.ylabel("Coefficient")
plt.subplot(1,2,2)
plt.plot(batch_sizes , intercept , 'o-b' ,color = 'blue')
plt.title("Intercept vs Batch Size")
plt.xlabel("Batch Size")
plt.ylabel("Intercept")
plt.show()
